<?xml version="1.0" encoding="UTF-8"?>
<toolspec model="0.1" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:noNamespaceSchemaLocation="../xa-toolwrapper/src/main/resources/toolspec.xsd">
    <id>convert</id>
    <name>FFmpeg convert</name>
    <homepage>http://ffmpeg.org/</homepage>
    <version>1.0</version>
    <installation>
        <os type="linux">
            Install ffmpeg
        </os>
        <os type="windows">
            Install ffmpeg
        </os>
    </installation>
    <services>
        <service sid="1" name="FFmpeg" type="migrate"
            servicepackage="eu.scape_project.pc.services" contextpathprefix="/scapeservices">
            <description>FFmpeg convertion service</description>
            <operations>
                
                <operation oid="1" name="video2mpeg2">
                    <description>Converts any FFmpeg supported video format to MPEG2</description>
                    <command>ffmpeg -y -i ${input} -vcodec mpeg2video -acodec ac3 ${output}</command>
                    <inputs>
                        <input name="input">
                            <Datatype>xsd:anyURI</Datatype>
                            <Required>true</Required>
                            <Default>http://localhost:8080/scape/testdata/video/big_buck_bunny_480p_stereo.ogg</Default>
                            <CliMapping>input</CliMapping>
                            <Documentation>URL reference to input file</Documentation>
                        </input>
                    </inputs>
                    <outputs>
                        <output name="output">
                            <Datatype>xsd:anyURI</Datatype>
                            <CliMapping>output</CliMapping>
                            <Required>false</Required>
                            <Documentation>URL reference to output file</Documentation>
                            <PrefixFromInput>input</PrefixFromInput>
                            <Extension>mpeg</Extension>
                        </output>
                    </outputs>
                </operation>

                <operation oid="2" name="video2flv">
                    <description>Converts any FFmpeg supported video format to FLV</description>
                    <command>ffmpeg -y -i ${input} -ar 44100 ${output}</command>
                    <inputs>
                        <input name="input">
                            <Datatype>xsd:anyURI</Datatype>
                            <Required>true</Required>
                            <Default>http://localhost:8080/scape/testdata/video/big_buck_bunny_480p_stereo.ogg</Default>
                            <CliMapping>input</CliMapping>
                            <Documentation>URL reference to input file</Documentation>
                        </input>
                    </inputs>
                    <outputs>
                        <output name="output">
                            <Datatype>xsd:anyURI</Datatype>
                            <CliMapping>output</CliMapping>
                            <Required>false</Required>
                            <Documentation>URL reference to output file</Documentation>
                            <PrefixFromInput>input</PrefixFromInput>
                            <Extension>flv</Extension>
                        </output>
                    </outputs>
                </operation>

                <operation oid="3" name="audio2aac">
                    <description>Converts any FFmpeg supported audio format to AAC</description>
                    <command>ffmpeg -y -i ${input} -acodec libfaac -ab 192k ${output}</command>
                    <inputs>
                        <input name="input">
                            <Datatype>xsd:anyURI</Datatype>
                            <Required>true</Required>
                            <Default>http://localhost:8080/scape/testdata/audio/nin-ghosts_I-2.mp3</Default>
                            <CliMapping>input</CliMapping>
                            <Documentation>URL reference to input file</Documentation>
                        </input>
                    </inputs>
                    <outputs>
                        <output name="output">
                            <Datatype>xsd:anyURI</Datatype>
                            <CliMapping>output</CliMapping>
                            <Required>false</Required>
                            <Documentation>URL reference to output file</Documentation>
                            <PrefixFromInput>input</PrefixFromInput>
                            <Extension>aac</Extension>
                        </output>
                    </outputs>
                </operation>

                <operation oid="4" name="audio2mp3">
                    <description>Converts any FFmpeg supported audio format to MP3</description>
                    <command>ffmpeg -y -i ${input} -ab 320k ${output}</command>
                    <inputs>
                        <input name="input">
                            <Datatype>xsd:anyURI</Datatype>
                            <Required>true</Required>
                            <Default>http://localhost:8080/scape/testdata/audio/nin-ghosts_I-2.mp3</Default>
                            <CliMapping>input</CliMapping>
                            <Documentation>URL reference to input file</Documentation>
                        </input>
                    </inputs>
                    <outputs>
                        <output name="output">
                            <Datatype>xsd:anyURI</Datatype>
                            <CliMapping>output</CliMapping>
                            <Required>false</Required>
                            <Documentation>URL reference to output file</Documentation>
                            <PrefixFromInput>input</PrefixFromInput>
                            <Extension>mp3</Extension>
                        </output>
                    </outputs>
                </operation>
                
                <operation oid="5" name="image2tiff">
                    <description>Converts any FFmpeg supported image format to TIFF</description>
                    <command>ffmpeg -y -i ${input} ${output}</command>
                    <inputs>
                        <input name="input">
                            <Datatype>xsd:anyURI</Datatype>
                            <Required>true</Required>
                            <Default>http://localhost:8080/scape/testdata/elephant.jpg</Default>
                            <CliMapping>input</CliMapping>
                            <Documentation>URL reference to input file</Documentation>
                        </input>
                    </inputs>
                    <outputs>
                        <output name="output">
                            <Datatype>xsd:anyURI</Datatype>
                            <CliMapping>output</CliMapping>
                            <Required>false</Required>
                            <Documentation>URL reference to output file</Documentation>
                            <PrefixFromInput>input</PrefixFromInput>
                            <Extension>tiff</Extension>
                        </output>
                    </outputs>
                </operation>

                <operation oid="6" name="txt2tiff">
                    <description>Converts Text to TIFF</description>
                    <command>ffmpeg -y -i ${input} ${output}</command>
                    <inputs>
                        <input name="input">
                            <Datatype>xsd:anyURI</Datatype>
                            <Required>true</Required>
                            <Default>http://localhost:8080/scape/testdata/free-text.txt</Default>
                            <CliMapping>input</CliMapping>
                            <Documentation>URL reference to input file</Documentation>
                        </input>
                    </inputs>
                    <outputs>
                        <output name="output">
                            <Datatype>xsd:anyURI</Datatype>
                            <CliMapping>output</CliMapping>
                            <Required>false</Required>
                            <Documentation>URL reference to output file</Documentation>
                            <PrefixFromInput>input</PrefixFromInput>
                            <Extension>tiff</Extension>
                        </output>
                    </outputs>
                </operation>
                
            </operations>
            <deployto>
                <deployref default="true" ref="local"/>
            </deployto>
        </service>

    </services>
    <deployments>
        <deployment id="local">
            <identifier>http://localhost:8080/scape/instances/tomcat1</identifier>
            <host>localhost</host>
            <ports>
                <port type="http">8080</port>
                <port type="https">8043</port>
            </ports>
            <manager>
                <user>tomcat</user>
                <password>tomcat</password>
                <path>manager</path>
            </manager>
            <dataexchange>
                <!--<accessdir>../webapps/ROOT/scape/tmp/</accessdir>-->
                <accessdir>webapps/ROOT/scape/tmp/</accessdir>
                <accessurl>http://localhost:8080/scape/tmp/</accessurl>
            </dataexchange>
        </deployment>
    </deployments>
</toolspec>
